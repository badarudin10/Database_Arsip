<!DOCTYPE html>

<html>
<head>
<script src="https://cdn.tailwindcss.com"></script>
<title>Arsip Digital Biipsite</title>
</head>
<body class="bg-gray-100 p-5">
<div class="max-w-xl mx-auto bg-white p-6 rounded shadow-xl mt-10">
<h2 class="text-xl font-bold mb-4 text-center text-blue-600">UPLOAD ARSIP DIGITAL</h2>
<input type="text" id="n" placeholder="Nama Dokumen" class="w-full border p-2 mb-2 rounded">
<select id="k" class="w-full border p-2 mb-2 rounded">
<option>Surat Masuk</option>
<option>Data Pegawai</option>
<option>Absen Pegawai</option>
<option>SPPD</option>
<option>Arsip Kegiatan</option>
</select>
<input type="date" id="t" class="w-full border p-2 mb-2 rounded">
<input type="file" id="f" class="w-full border p-2 mb-4 rounded">
<button onclick="up()" id="btn" class="w-full bg-blue-600 text-white p-3 rounded font-bold">SIMPAN KE ARSIP</button>
</div>

<script>
const URL_MESIN = "https://script.google.com/macros/s/AKfycbyV3oYcZKg755jiglbrwV00E41K80XDac952-9pcJSLDjfhiuftYfKiEpehxBISjY0I/exec";

function up() {
const fileInput = document.getElementById('f');
const btn = document.getElementById('btn');
const file = fileInput.files[0];
const reader = new FileReader();
btn.innerText = "Sedang Mengirim...";
btn.disabled = true;
reader.onload = function(e) {
const payload = {
data: e.target.result.split(',')[1],
type: file.type,
name: file.name,
namaDoc: document.getElementById('n').value,
kategori: document.getElementById('k').value,
tglDoc: document.getElementById('t').value
};
fetch(URL_MESIN, { method: "POST", body: JSON.stringify(payload) })
.then(() => { alert("Berhasil!"); location.reload(); })
.catch(() => { alert("Selesai!"); location.reload(); });
};
reader.readAsDataURL(file);
}
</script>

</body>
</html>
